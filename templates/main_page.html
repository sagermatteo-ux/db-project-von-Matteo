{% extends "base.html" %}

{% block content %}

<!-- 1Ô∏è‚É£ Notifications oben -->
{% if notifications %}
<div class="notifications mb-3">
    {% for note in notifications %}
        <div class="alert alert-info">{{ note.message }}</div>
    {% endfor %}
</div>
{% endif %}

<!-- 2Ô∏è‚É£ Todo / Material Liste -->
<ul class="todo-list list-unstyled">
    {% for todo in todos %}
    <li class="todo-item mb-2">

        <!-- Erledigt-Formular -->
        <form action="/complete" method="POST" class="d-inline-block">
            <input type="hidden" name="id" value="{{ todo.id }}">
            <input
                type="checkbox"
                id="todo-{{ todo.id }}"
                name="complete"
                value="1"
                class="todo-checkbox me-2"
                onchange="this.form.submit()">
            <label for="todo-{{ todo.id }}">
                {{ todo.content }}
                <br>
                <small>üìç {{ todo.location }}</small>
            </label>
        </form>

        <!-- Mieten-Button nur f√ºr fremde Gegenst√§nde -->
        {% if todo.user_id != current_user.id %}
        <form action="{{ url_for('rent', material_id=todo.id) }}" method="POST" class="d-inline-block ms-2">
            <button type="submit" class="btn btn-success btn-sm">Mieten</button>
        </form>
        {% endif %}

    </li>
    {% else %}
    <div class="text-muted">...Keine ver√∂ffentlichten Gegenst√§nde‚ùó</div>
    {% endfor %}
</ul>

<!-- 3Ô∏è‚É£ Formular f√ºr neues Material -->
<div class="todo-form mt-4">
    <form action="." method="POST">
        <div class="mb-3">
            <label for="contents" class="form-label">Gegenstand einf√ºgen</label>
            <input type="text" id="contents" name="contents" class="form-control"
                   placeholder="Neuen Gegenstand eingeben..." required>
        </div>

        <div class="mb-3">
            <label for="category" class="form-label">Kategorie</label>
            <select id="category" name="category" class="form-select" required>
                <option value="" disabled selected>Bitte w√§hlen</option>
                <option value="buecher">B√ºcher</option>
                <option value="taschenrechner">Taschenrechner</option>
                <option value="lineal_geodreieck">Lineal und Geodreieck</option>
                <option value="zirkel">Zirkel</option>
                <option value="schreibmaterial">Schreibmaterial</option>
            </select>
            <div class="form-text">W√§hle die Kategorie, zu der dein Gegenstand geh√∂rt.</div>
        </div>

        <div class="mb-3">
            <label for="location" class="form-label">Ort</label>
            <input type="text" id="location" name="location" class="form-control"
                   placeholder="z. B. Zimmer 512" required>
            <div class="form-text">Wo befindet sich der Gegenstand?</div>
        </div>

        <button type="submit" class="btn btn-primary">Hinzuf√ºgen</button>
    </form>
</div>

{% endblock %}

  