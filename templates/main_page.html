{% extends "base.html" %}
{% block content %}

<h2>Verf√ºgbare Gegenst√§nde</h2>
<ul class="todo-list">
{% for todo in todos %}
<li class="todo-item">

{% if todo.user_id != current_user.id %}
<form method="POST" action="{{ url_for('rent', material_id=todo.id) }}">
    <label>
        <strong>{{ todo.content }}</strong><br>
        <small>üìç {{ todo.location }} | Kategorie: {{ todo.cat }}</small>
    </label>

    {% if todo.status == 'pending' %}
        <span class="request-badge pending">‚úî Anfrage geschickt</span>
    {% elif todo.status == 'accepted' %}
        <span class="request-badge accepted">‚úî Anfrage akzeptiert</span>
    {% elif todo.status == 'rejected' %}
        <span class="request-badge rejected">‚úñ Anfrage abgelehnt</span>
    {% else %}
        <button type="submit" class="btn btn-success">Mieten</button>
    {% endif %}
</form>

{% else %}
<label>
    <strong>{{ todo.content }}</strong><br>
    <small>üìç {{ todo.location }} | Kategorie: {{ todo.cat }}</small>
</label>

<form method="POST" action="{{ url_for('delete_material', material_id=todo.id) }}" style="display:inline">
    <button class="btn btn-danger" onclick="return confirm('Willst du diesen Gegenstand wirklich l√∂schen?');">
        L√∂schen
    </button>
</form>
{% endif %}

</li>
{% else %}
<p>‚ùó Keine ver√∂ffentlichten Gegenst√§nde</p>
{% endfor %}
</ul>

<h2>Neuen Gegenstand hinzuf√ºgen</h2>
<form method="POST">
    <input name="contents" required placeholder="Gegenstand">
    <select name="category" required>
        <option disabled selected>Kategorie</option>
        <option value="buecher">B√ºcher</option>
        <option value="taschenrechner">Taschenrechner</option>
        <option value="lineal_geodreieck">Lineal & Geodreieck</option>
        <option value="zirkel">Zirkel</option>
        <option value="schreibmaterial">Schreibmaterial</option>
    </select>
    <input name="location" required placeholder="Ort">
    <button class="btn btn-primary">Hinzuf√ºgen</button>
</form>

<style>
.todo-list { list-style: none; padding: 0; }
.todo-item { margin-bottom: 15px; }

.request-badge { padding: 6px 12px; border-radius:6px; font-weight:bold; margin-left:10px; }
.request-badge.pending { background:#fff3cd; color:#664d03; }
.request-badge.accepted { background:#d1e7dd; color:#0f5132; }
.request-badge.rejected { background:#f8d7da; color:#842029; }

.btn-danger { background:#dc3545; color:white; border:none; padding:8px 14px; border-radius:6px; }
</style>

{% endblock %}
