{% extends "base.html" %}
{% block content %}

<h2>Verf√ºgbare Gegenst√§nde</h2>
<ul class="todo-list">
{% for todo in todos %}
<li class="todo-item">
    {% if todo.user_id != current_user.id %}
    <form method="POST" action="{{ url_for('rent', material_id=todo.id) }}">
        <label>
            <strong>{{ todo.content }}</strong><br>
            <small>üìç {{ todo.location }} | Kategorie: {{ todo.cat }}</small>
        </label>
        {% if todo.requested %}
            <span class="request-badge">‚úî Anfrage geschickt</span>
        {% else %}
            <button type="submit" class="btn btn-success">Mieten</button>
        {% endif %}
    </form>
    {% else %}
    <label>
        <strong>{{ todo.content }}</strong><br>
        <small>üìç {{ todo.location }} | Kategorie: {{ todo.cat }}</small>
    </label>
    <form method="POST" action="{{ url_for('delete_material', material_id=todo.id) }}" style="display:inline">
        <button type="submit" class="btn btn-danger" onclick="return confirm('Willst du diesen Gegenstand wirklich l√∂schen?');">
            L√∂schen
        </button>
    </form>
    {% endif %}
</li>
{% else %}
<div>‚ùó Keine ver√∂ffentlichten Gegenst√§nde</div>
{% endfor %}
</ul>

<h2>Offene Anfragen f√ºr deine Gegenst√§nde</h2>
<ul>
{% for r in requests %}
<li>
    {{ r.requester_name }} m√∂chte {{ r.material_name }} mieten
    <form method="POST" action="{{ url_for('accept_request', req_id=r.id) }}" style="display:inline">
        <button class="btn btn-success">Akzeptieren</button>
    </form>
    <form method="POST" action="{{ url_for('reject_request', req_id=r.id) }}" style="display:inline">
        <button class="btn btn-warning">Ablehnen</button>
    </form>
</li>
{% else %}
<div>Keine offenen Anfragen</div>
{% endfor %}
</ul>

<h2>Benachrichtigungen</h2>
<ul>
{% for n in notifications %}
<li {% if not n.is_read %}style="font-weight:bold"{% endif %}>
    {{ n.message }} ({{ n.material_name }})
</li>
{% else %}
<div>Keine Benachrichtigungen</div>
{% endfor %}
</ul>

<h2>Neuen Gegenstand hinzuf√ºgen</h2>
<form method="POST">
    <input name="contents" required placeholder="Gegenstand">
    <select name="category" required>
        <option value="" disabled selected>Kategorie</option>
        <option value="buecher">B√ºcher</option>
        <option value="taschenrechner">Taschenrechner</option>
        <option value="lineal_geodreieck">Lineal & Geodreieck</option>
        <option value="zirkel">Zirkel</option>
        <option value="schreibmaterial">Schreibmaterial</option>
    </select>
    <input name="location" required placeholder="Ort">
    <button class="btn btn-primary">Hinzuf√ºgen</button>
</form>

<style>
.todo-list { list-style: none; padding: 0; }
.todo-item { margin-bottom: 15px; }
.request-badge { display: inline-block; padding: 8px 14px; background-color: #f8d7da; color: #842029; border: 2px solid #842029; border-radius: 6px; font-weight: bold; margin-left: 10px; }
.btn-danger { background-color: #dc3545; border: none; color: white; padding: 8px 14px; border-radius: 6px; cursor: pointer; }
.btn-danger:hover { background-color: #bb2d3b; }
.btn-success { background-color: #198754; border: none; color: white; padding: 8px 10px; border-radius: 6px; cursor: pointer; }
.btn-success:hover { background-color: #146c43; }
.btn-warning { background-color: #ffc107; border: none; color: black; padding: 8px 10px; border-radius: 6px; cursor: pointer; }
.btn-warning:hover { background-color: #e0a800; }
</style>

{% endblock %}